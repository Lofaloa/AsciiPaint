<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>CommandManager.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;AsciiPaint&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">g47923.asciipaint.controller</a> &gt; <span class="el_source">CommandManager.java</span></div><h1>CommandManager.java</h1><pre class="source lang-java linenums">package g47923.asciipaint.controller;

import g47923.asciipaint.model.AsciiPaint;
import java.util.Arrays;
import g47923.asciipaint.view.View;
import static java.lang.Integer.parseInt;
import java.util.Locale;

/**
 * Manages the commands.
 *
 * @author g47923
 */
class CommandManager {

    private final AsciiPaint asciiPaint;
    private final String[] commandNames;
    private final String[] shapeNames;

    /**
     * Initializes this command manager with the given game.
     *
     * @param asciipaint is the game to control.
     */
<span class="nc" id="L25">    public CommandManager(AsciiPaint asciipaint) {</span>
<span class="nc" id="L26">        this.asciiPaint = asciipaint;</span>
<span class="nc" id="L27">        this.commandNames = new String[]{&quot;add&quot;, &quot;show&quot;, &quot;remove&quot;, &quot;move&quot;, &quot;exit&quot;,</span>
            &quot;help&quot;};
<span class="nc" id="L29">        this.shapeNames = new String[]{&quot;circle&quot;, &quot;rectangle&quot;, &quot;triangle&quot;, &quot;square&quot;};</span>
<span class="nc" id="L30">    }</span>

    /**
     * Tells if the given string is a command name.
     *
     * @param str is the string to analyze.
     * @return true if the given string is a command name.
     */
    boolean isCommandName(String str) {
<span class="nc" id="L39">        return Arrays.asList(commandNames).contains(str);</span>
    }

    /**
     * Tells if the given string is a shape name.
     *
     * @param str is the string to analyze.
     * @return true if the given string is a shape name.
     */
    boolean isShapeName(String str) {
<span class="nc" id="L49">        return Arrays.asList(shapeNames).contains(str);</span>
    }

    /**
     * Splits the given line after a white space.
     *
     * @param line is the line to split.
     * @return an array of the split strings.
     */
    public String[] splitLine(String line) {
<span class="nc" id="L59">        return line.split(&quot;\\s+&quot;);</span>
    }

    /**
     * Makes sure that the given string is a command name. Three commands are
     * known: add, show and exit.
     *
     * @param str is the string to parse.
     * @return the given command name.
     * @throws IllegalArgumentException if the given string is not a command.
     */
    String requireCommandName(String str) {
<span class="nc bnc" id="L71" title="All 2 branches missed.">        if (!isCommandName(str.toLowerCase(Locale.getDefault()))) {</span>
<span class="nc" id="L72">            throw new IllegalArgumentException(&quot;\&quot;&quot; + str + &quot;\&quot; is not &quot;</span>
                    + &quot;a command.&quot;);
        }
<span class="nc" id="L75">        return str;</span>
    }

    /**
     * Makes sure that the given string is a shape name. Four shape names are
     * known: circle, rectangle, triangle and square.
     *
     * @param str is the string to parse.
     * @return the given shape name.
     * @throws IllegalArgumentException if the given string is not a shape name.
     */
    String requireShapeName(String str) {
<span class="nc bnc" id="L87" title="All 2 branches missed.">        if (!isShapeName(str.toLowerCase(Locale.getDefault()))) {</span>
<span class="nc" id="L88">            throw new IllegalArgumentException(&quot;\&quot;&quot; + str + &quot;\&quot; is not &quot;</span>
                    + &quot;a valid shape name.&quot;);
        }
<span class="nc" id="L91">        return str;</span>
    }

    /**
     * Adds a new rectangle corresponding to the given arguments.
     *
     * @param args are the characteristics of the added rectangle.
     * @throws IllegalArgumentException if args lacks required argument.
     */
    void addNewRectangle(String[] args) {
<span class="nc bnc" id="L101" title="All 2 branches missed.">        if (args.length &lt; 5) {</span>
<span class="nc" id="L102">            throw new IllegalArgumentException(&quot;Arguments undefined, a &quot;</span>
                    + &quot;rectangle requires: x, y, width, length and a color.&quot;);
        }
<span class="nc" id="L105">        asciiPaint.newRectangle(parseInt(args[0]), parseInt(args[1]),</span>
<span class="nc" id="L106">                parseInt(args[2]), parseInt(args[3]), args[4].charAt(0));</span>
<span class="nc" id="L107">    }</span>

    /**
     * Adds a new square corresponding to the given arguments.
     *
     * @param args are the characteristics of the added square.
     * @throws IllegalArgumentException if args lacks required argument.
     *
     */
    void addNewSquare(String[] args) {
<span class="nc bnc" id="L117" title="All 2 branches missed.">        if (args.length &lt; 4) {</span>
<span class="nc" id="L118">            throw new IllegalArgumentException(&quot;Arguments undefined, a &quot;</span>
                    + &quot;square requires: x, y, side and a color.&quot;);
        }
<span class="nc" id="L121">        asciiPaint.newSquare(parseInt(args[0]), parseInt(args[1]),</span>
<span class="nc" id="L122">                parseInt(args[2]), args[3].charAt(0));</span>
<span class="nc" id="L123">    }</span>

    /**
     * Adds a new circle corresponding to the given arguments.
     *
     * @param args are the characteristics of the added circle.
     * @throws IllegalArgumentException if args lacks required argument.
     *
     */
    void addNewCircle(String[] args) {
<span class="nc bnc" id="L133" title="All 2 branches missed.">        if (args.length &lt; 4) {</span>
<span class="nc" id="L134">            throw new IllegalArgumentException(&quot;Arguments undefined, a &quot;</span>
                    + &quot;circle requires: x, y, radius and a color.&quot;);
        }
<span class="nc" id="L137">        asciiPaint.newCircle(parseInt(args[0]), parseInt(args[1]),</span>
<span class="nc" id="L138">                parseInt(args[2]), args[3].charAt(0));</span>
<span class="nc" id="L139">    }</span>

    /**
     * Adds a new triangle corresponding to the given arguments.
     *
     * @param args are the characteristics of the added triangle.
     * @throws IllegalArgumentException if args lacks required argument.
     */
    void addNewTriangle(String... args) {
<span class="nc bnc" id="L148" title="All 2 branches missed.">        if (args.length &lt; 7) {</span>
<span class="nc" id="L149">            throw new IllegalArgumentException(&quot;Arguments undefined, a &quot;</span>
                    + &quot;triangle requires: x1, y1, x2, y2, x3, y3 and a color.&quot;);
        }
<span class="nc" id="L152">        asciiPaint.newTriangle(parseInt(args[0]), parseInt(args[1]),</span>
<span class="nc" id="L153">                parseInt(args[2]), parseInt(args[3]), parseInt(args[4]),</span>
<span class="nc" id="L154">                parseInt(args[5]), args[6].charAt(0));</span>
<span class="nc" id="L155">    }</span>

    /**
     * Adds a new shape to the game drawing.
     *
     * @param shape is the name of the shape.
     * @param args are the argument of the shape.
     * @throws IllegalArgumentException is the given shape name does not exist.
     */
    void addNewShape(String shape, String... args) {
<span class="nc bnc" id="L165" title="All 18 branches missed.">        switch (shape) {</span>
            case &quot;circle&quot;:
<span class="nc" id="L167">                addNewCircle(args);</span>
<span class="nc" id="L168">                break;</span>
            case &quot;square&quot;:
<span class="nc" id="L170">                addNewSquare(args);</span>
<span class="nc" id="L171">                break;</span>
            case &quot;rectangle&quot;:
<span class="nc" id="L173">                addNewRectangle(args);</span>
<span class="nc" id="L174">                break;</span>
            case &quot;triangle&quot;:
<span class="nc" id="L176">                addNewTriangle(args);</span>
<span class="nc" id="L177">                break;</span>
            default:
<span class="nc" id="L179">                throw new IllegalArgumentException(&quot;\&quot;&quot; + shape + &quot;\&quot; is not a &quot;</span>
                        + &quot;shape.&quot;);
        }
<span class="nc" id="L182">    }</span>

    /**
     * Moves the shape containing the given point.
     *
     * @param x is the x position of the point.
     * @param y is the y position of the point.
     * @param dx is the difference added to the x position of the shape to move.
     * @param dy is the difference added to the y position of the shape to move.
     * @throws IllegalArgumentException if there is no shape to move.
     */
    void moveShapeAt(String x, String y, String dx, String dy) {
<span class="nc" id="L194">        asciiPaint.moveShapeAt(parseInt(x), parseInt(y), parseInt(dx),</span>
<span class="nc" id="L195">                parseInt(dy));</span>
<span class="nc" id="L196">    }</span>

    /**
     * Removes the shape containing the given point.
     *
     * @param x is the x position of the point.
     * @param y is the y position of the point.
     * @throws IllegalArgumentException if there is no shape to remove.
     */
    void removeShapeAt(String x, String y) {
<span class="nc" id="L206">        asciiPaint.removeShapeAt(parseInt(x), parseInt(y));</span>
<span class="nc" id="L207">    }</span>

    /**
     * Executes the command entered by the user.
     *
     * @param tokens are the tokens forming the command to run.
     * @return true if the user ask for exiting the program.
     */
    public boolean executeCommand(String[] tokens) {
<span class="nc bnc" id="L216" title="All 2 branches missed.">        if (tokens.length == 0) {</span>
<span class="nc" id="L217">            throw new IllegalArgumentException(&quot;No tokens to parse.&quot;);</span>
        }
<span class="nc bnc" id="L219" title="All 22 branches missed.">        switch (requireCommandName(tokens[0])) {</span>
            case &quot;add&quot;:
<span class="nc bnc" id="L221" title="All 2 branches missed.">                if (tokens.length == 1) {</span>
<span class="nc" id="L222">                    throw new IllegalArgumentException(&quot;add requires arguments.&quot;);</span>
                }
<span class="nc" id="L224">                addNewShape(requireShapeName(tokens[1]),</span>
<span class="nc" id="L225">                        Arrays.copyOfRange(tokens, 2, tokens.length));</span>
<span class="nc" id="L226">                break;</span>
            case &quot;remove&quot;:
<span class="nc bnc" id="L228" title="All 2 branches missed.">                if (tokens.length &lt; 3) {</span>
<span class="nc" id="L229">                    throw new IllegalArgumentException(&quot;Not enough arguments,&quot;</span>
                            + &quot; remove requires: x and y.&quot;);
                }
<span class="nc" id="L232">                removeShapeAt(tokens[1], tokens[2]);</span>
<span class="nc" id="L233">                break;</span>
            case &quot;move&quot;:
<span class="nc bnc" id="L235" title="All 2 branches missed.">                if (tokens.length &lt; 5) {</span>
<span class="nc" id="L236">                    throw new IllegalArgumentException(&quot;Not enough arguments, &quot;</span>
                            + &quot;move requires: x, y, dx, dy.&quot;);
                }
<span class="nc" id="L239">                moveShapeAt(tokens[1], tokens[2], tokens[3], tokens[4]);</span>
<span class="nc" id="L240">                break;</span>
            case &quot;help&quot;:
<span class="nc" id="L242">                new View(asciiPaint).printHelp();</span>
<span class="nc" id="L243">                break;</span>
            case &quot;show&quot;:
<span class="nc" id="L245">                System.out.println(asciiPaint.asAscii());</span>
<span class="nc" id="L246">                break;</span>
            default:
<span class="nc" id="L248">                return true;</span>
        }
<span class="nc" id="L250">        return false;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>